(window.webpackJsonp=window.webpackJsonp||[]).push([[4,3],{419:function(e,t,r){var content=r(423);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(38).default)("7dc8f0ea",content,!0,{sourceMap:!1})},422:function(e,t,r){"use strict";r(419)},423:function(e,t,r){var n=r(37)(!1);n.push([e.i,".v-text-field[data-v-add5d958]{padding:10px}#liveFeed[data-v-add5d958]{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:#000}#chat[data-v-add5d958],#liveFeed[data-v-add5d958]{display:none}#msgList[data-v-add5d958]{height:200px;overflow-y:scroll}#msg[data-v-add5d958]{padding-bottom:5px}#localStream[data-v-add5d958]{position:absolute;bottom:0;left:0;width:300px;transform:scaleX(-1);margin:20px;border:2px solid #fff}#remoteStream[data-v-add5d958]{position:absolute;max-width:100%;height:100%;top:50%;left:50%;transform:translate(-50%,-50%)}#startCall[data-v-add5d958],#turnServer[data-v-add5d958]{background-color:green}#endCall[data-v-add5d958],#startCall[data-v-add5d958],#turnServer[data-v-add5d958]{padding:5px;color:#fff;border:none}#endCall[data-v-add5d958]{position:absolute;bottom:10px;right:10px;background-color:red}",""]),e.exports=n},424:function(e,t,r){"use strict";r.r(t);var n=r(258),o=r(426),l=r(417),c=r(483),d=r(415),v=r(428),m=r(421),f=r(418),h=r(482),y=r(484),k=r(62),_=r(420),x=r(26),w=(r(90),r(52),r(45),r(39),r(70),r(81),r(63),r(9),r(94)),S=r(430),j=Object(w.b)({name:"Messenger",setup:function(){var e=Object(w.f)(),t=Object(w.d)(),r=Object(w.d)(e.value.query.peerId?e.value.query.peerId:""),n=Object(w.d)(),o=Object(w.d)(),l=Object(w.d)(),c=Object(w.d)(),d=window.location.href.split(":"),v=Object(w.d)(d[1].slice(2)),m=Object(w.d)(Number(d[2].split("/")[0])+1),f=Object(w.d)(d[2].split("/")[0]),h=Object(w.d)("https://".concat(v.value,":").concat(m.value,"/myapp")),y=Object(w.d)(v.value),k=Object(w.d)(m.value),_=Object(w.a)((function(){return!!d[1].slice(2).includes("192.168")})),j=Object(w.d)({myid:t.value,peerId:r.value,peer:n.value,message:"",messages:[]});function O(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+(e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())}function C(){return(C=Object(x.a)(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.ipify.org?format=json",{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.error(e)}));case 2:t=e.sent,r=t.ip,l.value=r;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(x.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(c.value);case 3:alert("Local area network link copied to clipboard."),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),alert("Cannot copy");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function P(){return(P=Object(x.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d[1].slice(2).includes("192.168")&&(c.value="https://".concat(l.value,":").concat(f.value,"/dashboard?peerId=").concat(t.value)),e.prev=1,e.next=4,navigator.clipboard.writeText(c.value);case 4:alert("Public Link copied to clipboard."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),alert("Cannot copy");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}!function(){C.apply(this,arguments)}();var L=.7*window.innerHeight,R=new S.a({host:v.value,secure:!0,port:m.value,path:"/myapp"});function M(){return(M=Object(x.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.value.peer.connect(j.value.peerId);case 2:(t=e.sent).on("open",(function(){var e={sender:o.value,peerId:j.value.myid,message:j.value.message,time:O()};t.send(e),j.value.messages.push(e),j.value.message=""})),T();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R.on("open",(function(e){t.value=e,c.value="https://".concat(v.value,":").concat(f.value,"/dashboard?peerId=").concat(t.value)})),R.on("connection",(function(e){e.on("data",(function(data){j.value.messages.push(data)})),T()}));var U=void 0;function N(){return(N=Object(x.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelector("#menu").style.display="block",document.querySelector("#liveFeed").style.display="none",document.querySelector("#chat").style.display="none",U){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,U.close();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:U=void 0;case 13:case"end":return e.stop()}}),e,null,[[5,10]])})))).apply(this,arguments)}function F(){return(F=Object(x.a)(regeneratorRuntime.mark((function e(){var o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value=new S.a({host:y.value,secure:!0,port:k.value,path:"/myapp"}),j.value.peer=n.value,e.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 4:o=e.sent,document.querySelector("#menu").style.display="none",document.querySelector("#liveFeed").style.display="block",document.querySelector("#chat").style.display="block",document.querySelector("#localStream").srcObject=o,document.querySelector("#localStream").play(),(l=n.value.call(r.value,o,{metadata:{id:t.value}})).on("stream",(function(e){document.querySelector("#remoteStream").srcObject=e,document.querySelector("#remoteStream").play()})),l.on("error",(function(e){console.log(e)})),l.on("close",(function(){n.value.disconnect()})),U=l;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){setTimeout((function(){var div=document.querySelector("#msgList");div.scrollTo(0,div.scrollHeight)}),200)}return R.on("call",(function(e){confirm("Accept incoming Call ".concat(e.peer,"?"))?(j.value.myid=t.value,j.value.peer=R,j.value.peerId=e.metadata.id,navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){document.querySelector("#localStream").srcObject=t,document.querySelector("#localStream").play(),e.answer(t),U=e,document.querySelector("#menu").style.display="none",document.querySelector("#liveFeed").style.display="block",document.querySelector("#chat").style.display="block",e.on("stream",(function(e){document.querySelector("#remoteStream").srcObject=e,document.querySelector("#remoteStream").play()}))})).catch((function(e){console.log("Failed to get local stream:",e)})),e.on("close",Object(x.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Called Ended"),t.next=3,e.close();case 3:case"end":return t.stop()}}),t)}))))):e.close()})),{showLocalLink:_,windowHeight:L,rules:[function(e){return!!e||"Required."},function(e){return e&&e.length>=3||"Min 3 characters"}],yourPeerId:t,peerId:r,userName:o,host:y,port:k,endCall:function(){return N.apply(this,arguments)},callUser:function(){return F.apply(this,arguments)},sendMsg:function(){return M.apply(this,arguments)},state:j,myIp:l,createUrlLocalLink:function(){return I.apply(this,arguments)},createUrlPublicLink:function(){return P.apply(this,arguments)},reloadPage:function(){setTimeout((function(){alert("Press 'Ok' to reload the page after loading turn server page successfully."),location.reload()}),1e3)},signalServerPort:m,signalServerUrl:h,scrollBottom:T}}}),O=j,C=(r(422),r(93)),component=Object(C.a)(O,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t(h.a,[t(c.a,{attrs:{cols:"4"}},[t(o.a,[t(l.c,[e._v(" Configuration ")]),e._v(" "),t(y.a,{attrs:{label:"Your Peer Id",disabled:"","hide-details":"auto"},on:{focus:function(e){return e.target.select()}},model:{value:e.yourPeerId,callback:function(t){e.yourPeerId=t},expression:"yourPeerId"}}),e._v(" "),t(l.a,[t(h.a,[e.showLocalLink?t(c.a,[t(n.a,{attrs:{color:"primary",title:"Use this link if your trying to connect to somone on your local area network."},on:{click:function(t){return e.createUrlLocalLink()}}},[e._v("Local Link\n              ")])],1):e._e(),e._v(" "),t(c.a,[t(n.a,{attrs:{color:"primary",title:"Use this link if your trying to connect to somone over the internet."},on:{click:function(t){return e.createUrlPublicLink()}}},[e._v("Public Link\n              ")])],1),e._v(" "),t(c.a,[null==e.yourPeerId?t(n.a,{attrs:{id:"turnServer",href:e.signalServerUrl,target:"_blank"},on:{click:function(t){return e.reloadPage()}}},[e._v("Connect Turn Server\n              ")]):e._e()],1)],1),e._v(" "),t(d.a,{attrs:{fluid:"","ma-0":"","pa-0":"","fill-height":""}},[void 0!==e.yourPeerId?t("div",{attrs:{id:"menu"}},[t(y.a,{attrs:{label:"Peer's ID",rules:e.rules,"hide-details":"auto"},model:{value:e.peerId,callback:function(t){e.peerId=t},expression:"peerId"}}),e._v(" "),t(y.a,{attrs:{label:"Your Name",rules:e.rules,"hide-details":"auto"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),t(y.a,{attrs:{label:"Host",rules:e.rules,"hide-details":"auto"},model:{value:e.host,callback:function(t){e.host=t},expression:"host"}}),e._v(" "),t(y.a,{attrs:{label:"Port",rules:e.rules,"hide-details":"auto"},model:{value:e.port,callback:function(t){e.port=t},expression:"port"}}),e._v(" "),t(n.a,{attrs:{id:"startCall"},on:{click:function(t){return e.callUser()}}},[e._v("Call")])],1):t("div",[e._v("Please connect to the Turn Server.")])])],1)],1),e._v(" "),t("div",{staticClass:"pt-3",attrs:{id:"chat"}},[t(o.a,{staticClass:"elevation-10"},[t(k.a,{attrs:{dark:"",color:"darken-1"}},[t(_.a,[e._v("Chat")])],1),e._v(" "),t(y.a,{attrs:{label:"Name",placeholder:"Enter your name"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),t(l.b,[t("div",{attrs:{id:"msgList"}},[t(v.a,{attrs:{shaped:""}},e._l(e.state.messages,(function(r,i){return t(m.a,{key:i},[t(f.a,{attrs:{id:"msg"}},[t("b",[e._v(e._s(r.sender)+" :")]),e._v(" "+e._s(r.message)+"\n                    "),t("i",[e._v("("+e._s(r.time)+")")])])],1)})),1)],1)]),e._v(" "),t(l.a,[t(y.a,{attrs:{label:"Message","single-line":"","solo-inverted":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMsg()}},model:{value:e.state.message,callback:function(t){e.$set(e.state,"message",t)},expression:"state.message"}}),e._v(" "),t("div",{staticClass:"pb-8"},[t(n.a,{attrs:{dark:""},on:{click:function(t){return e.sendMsg()}}},[e._v(" send ")])],1)],1)],1)],1)],1),e._v(" "),t(c.a,{attrs:{cols:"8"}},[t(o.a,{attrs:{height:e.windowHeight}},[t(l.c,[e._v(" Conversation ")]),e._v(" "),t("div",{attrs:{id:"liveFeed"}},[t("video",{attrs:{id:"remoteStream"}}),e._v(" "),t("video",{attrs:{id:"localStream",muted:"true"},domProps:{muted:!0}}),e._v(" "),t(n.a,{attrs:{id:"endCall"},on:{click:function(t){return e.endCall()}}},[e._v("End Call")])],1)],1)],1)],1)],1)}),[],!1,null,"add5d958",null);t.default=component.exports},485:function(e,t,r){"use strict";r.r(t);var n=r(94),o=r(424),l=Object(n.b)({name:"Dashboard",components:{Messenger:o.default},setup:function(){}}),c=r(93),component=Object(c.a)(l,(function(){var e=this._self._c;this._self._setupProxy;return e("messenger")}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Messenger:r(424).default})}}]);