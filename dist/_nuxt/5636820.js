(window.webpackJsonp=window.webpackJsonp||[]).push([[4,3],{419:function(e,t,r){var content=r(423);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(38).default)("bcfdcfe8",content,!0,{sourceMap:!1})},422:function(e,t,r){"use strict";r(419)},423:function(e,t,r){var n=r(37)(!1);n.push([e.i,".v-text-field[data-v-05c371ca]{padding:10px}#liveFeed[data-v-05c371ca]{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:#000}#chat[data-v-05c371ca],#liveFeed[data-v-05c371ca]{display:none}#msgList[data-v-05c371ca]{height:200px;overflow-y:scroll}#msg[data-v-05c371ca]{padding-bottom:5px}#localStream[data-v-05c371ca]{position:absolute;bottom:0;left:0;width:300px;transform:scaleX(-1);margin:20px;border:2px solid #fff}#remoteStream[data-v-05c371ca]{position:absolute;max-width:100%;height:100%;top:50%;left:50%;transform:translate(-50%,-50%)}#startCall[data-v-05c371ca]{background-color:green}#endCall[data-v-05c371ca],#startCall[data-v-05c371ca]{padding:5px;color:#fff;border:none}#endCall[data-v-05c371ca]{position:absolute;bottom:10px;right:10px;background-color:red}",""]),e.exports=n},424:function(e,t,r){"use strict";r.r(t);var n=r(258),o=r(425),c=r(417),l=r(483),d=r(427),v=r(421),m=r(418),f=r(482),h=r(484),y=r(62),_=r(420),k=r(26),x=(r(90),r(52),r(45),r(39),r(63),r(9),r(94)),S=r(429),w=Object(x.a)({name:"Messenger",setup:function(){var e=Object(x.e)(),t=Object(x.c)(),r=Object(x.c)(e.value.query.peerId?e.value.query.peerId:""),n=Object(x.c)(),o=Object(x.c)(),c=Object(x.c)(),l=Object(x.c)(),d=window.location.href.split(":"),v=Object(x.c)(d[1].slice(2)),m=Object(x.c)(Number(d[2].split("/")[0])+1),f=Object(x.c)(d[2].split("/")[0]),h=Object(x.c)("https://".concat(v.value,":").concat(m.value,"/myapp")),y=Object(x.c)(v.value),_=Object(x.c)(m.value),w=Object(x.c)({myid:t.value,peerId:r.value,peer:n.value,message:"",messages:[]});function j(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+(e.getHours()+":"+e.getMinutes()+":"+e.getSeconds())}function O(){return(O=Object(k.a)(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.ipify.org?format=json",{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.error(e)}));case 2:t=e.sent,r=t.ip,c.value=r;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(l.value);case 3:alert("Copied"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),alert("Cannot copy");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}!function(){O.apply(this,arguments)}();var I=.7*window.innerHeight,M=new S.a({host:v.value,secure:!0,port:m.value,path:"/myapp"});function R(){return(R=Object(k.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.value.peer.connect(w.value.peerId);case 2:(t=e.sent).on("open",(function(){var e={sender:o.value,peerId:w.value.myid,message:w.value.message,time:j()};t.send(e),w.value.messages.push(e),w.value.message=""})),U();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}M.on("open",(function(e){t.value=e,l.value="https://".concat(v.value,":").concat(f.value,"/dashboard?peerId=").concat(t.value)})),M.on("connection",(function(e){e.on("data",(function(data){w.value.messages.push(data)})),U()}));var P=void 0;function N(){return(N=Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelector("#menu").style.display="block",document.querySelector("#liveFeed").style.display="none",document.querySelector("#chat").style.display="none",P){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,P.close();case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(5);case 12:P=void 0;case 13:case"end":return e.stop()}}),e,null,[[5,10]])})))).apply(this,arguments)}function F(){return(F=Object(k.a)(regeneratorRuntime.mark((function e(){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.value=new S.a({host:y.value,secure:!0,port:_.value,path:"/myapp"}),w.value.peer=n.value,e.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 4:o=e.sent,document.querySelector("#menu").style.display="none",document.querySelector("#liveFeed").style.display="block",document.querySelector("#chat").style.display="block",document.querySelector("#localStream").srcObject=o,document.querySelector("#localStream").play(),(c=n.value.call(r.value,o,{metadata:{id:t.value}})).on("stream",(function(e){document.querySelector("#remoteStream").srcObject=e,document.querySelector("#remoteStream").play()})),c.on("error",(function(e){console.log(e)})),c.on("close",(function(){n.value.disconnect()})),P=c;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){setTimeout((function(){var div=document.querySelector("#msgList");div.scrollTo(0,div.scrollHeight)}),200)}return M.on("call",(function(e){confirm("Accept incoming Call ".concat(e.peer,"?"))?(w.value.myid=t.value,w.value.peer=M,w.value.peerId=e.metadata.id,navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){document.querySelector("#localStream").srcObject=t,document.querySelector("#localStream").play(),e.answer(t),P=e,document.querySelector("#menu").style.display="none",document.querySelector("#liveFeed").style.display="block",document.querySelector("#chat").style.display="block",e.on("stream",(function(e){document.querySelector("#remoteStream").srcObject=e,document.querySelector("#remoteStream").play()}))})).catch((function(e){console.log("Failed to get local stream:",e)})),e.on("close",Object(k.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Called Ended"),t.next=3,e.close();case 3:case"end":return t.stop()}}),t)}))))):e.close()})),{windowHeight:I,rules:[function(e){return!!e||"Required."},function(e){return e&&e.length>=3||"Min 3 characters"}],yourPeerId:t,peerId:r,userName:o,host:y,port:_,endCall:function(){return N.apply(this,arguments)},callUser:function(){return F.apply(this,arguments)},sendMsg:function(){return R.apply(this,arguments)},state:w,myIp:c,createUrlLink:function(){return C.apply(this,arguments)},signalServerPort:m,signalServerUrl:h,scrollBottom:U}}}),j=w,O=(r(422),r(93)),component=Object(O.a)(j,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t(f.a,[t(l.a,{attrs:{cols:"4"}},[t(o.a,[t(c.c,[e._v(" Configuration ")]),e._v(" "),t(h.a,{attrs:{label:"Your Public Ip"},model:{value:e.myIp,callback:function(t){e.myIp=t},expression:"myIp"}}),e._v(" "),t(h.a,{attrs:{label:"Your Peer Id",disabled:"","hide-details":"auto"},on:{focus:function(e){return e.target.select()}},model:{value:e.yourPeerId,callback:function(t){e.yourPeerId=t},expression:"yourPeerId"}}),e._v(" "),t(c.a,[t(f.a,[t(l.a,[t(n.a,{on:{click:function(t){return e.createUrlLink()}}},[e._v("Share Link ")])],1),e._v(" "),t(l.a,[t(n.a,{attrs:{href:e.signalServerUrl,target:"_blank"}},[e._v("Turn Server\n              ")])],1)],1),e._v(" "),t(f.a,[t(l.a,[t("div",{attrs:{id:"menu"}},[t(h.a,{attrs:{label:"Peer's ID",rules:e.rules,"hide-details":"auto"},model:{value:e.peerId,callback:function(t){e.peerId=t},expression:"peerId"}}),e._v(" "),t(h.a,{attrs:{label:"Your Name",rules:e.rules,"hide-details":"auto"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),t(h.a,{attrs:{label:"Host",rules:e.rules,"hide-details":"auto"},model:{value:e.host,callback:function(t){e.host=t},expression:"host"}}),e._v(" "),t(h.a,{attrs:{label:"Port",rules:e.rules,"hide-details":"auto"},model:{value:e.port,callback:function(t){e.port=t},expression:"port"}}),e._v(" "),t(n.a,{attrs:{id:"startCall"},on:{click:function(t){return e.callUser()}}},[e._v("Connect")])],1)])],1)],1)],1),e._v(" "),t("div",{staticClass:"pt-3",attrs:{id:"chat"}},[t(o.a,{staticClass:"elevation-10"},[t(y.a,{attrs:{dark:"",color:"darken-1"}},[t(_.a,[e._v("Chat")])],1),e._v(" "),t(h.a,{attrs:{label:"Name",placeholder:"Enter your name"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),e._v(" "),t(c.b,[t("div",{attrs:{id:"msgList"}},[t(d.a,{attrs:{shaped:""}},e._l(e.state.messages,(function(r,i){return t(v.a,{key:i},[t(m.a,{attrs:{id:"msg"}},[t("b",[e._v(e._s(r.sender)+" :")]),e._v(" "+e._s(r.message)+"\n                    "),t("i",[e._v("("+e._s(r.time)+")")])])],1)})),1)],1)]),e._v(" "),t(c.a,[t(h.a,{attrs:{label:"Message","single-line":"","solo-inverted":""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMsg()}},model:{value:e.state.message,callback:function(t){e.$set(e.state,"message",t)},expression:"state.message"}}),e._v(" "),t("div",{staticClass:"pb-8"},[t(n.a,{attrs:{dark:""},on:{click:function(t){return e.sendMsg()}}},[e._v(" send ")])],1)],1)],1)],1)],1),e._v(" "),t(l.a,{attrs:{cols:"8"}},[t(o.a,{attrs:{height:e.windowHeight}},[t(c.c,[e._v(" Conversation ")]),e._v(" "),t("div",{attrs:{id:"liveFeed"}},[t("video",{attrs:{id:"remoteStream"}}),e._v(" "),t("video",{attrs:{id:"localStream",muted:"true"},domProps:{muted:!0}}),e._v(" "),t(n.a,{attrs:{id:"endCall"},on:{click:function(t){return e.endCall()}}},[e._v("End Call")])],1)],1)],1)],1)],1)}),[],!1,null,"05c371ca",null);t.default=component.exports},485:function(e,t,r){"use strict";r.r(t);var n=r(94),o=r(424),c=Object(n.a)({name:"Dashboard",components:{Messenger:o.default},setup:function(){}}),l=r(93),component=Object(l.a)(c,(function(){var e=this._self._c;this._self._setupProxy;return e("messenger")}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Messenger:r(424).default})}}]);